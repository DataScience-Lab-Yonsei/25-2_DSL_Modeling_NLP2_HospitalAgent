# 💬 실시간 채팅 인터페이스 가이드

## 🚀 시작하기

### 실행 방법
```bash
python chat_interface.py
```

### 환경 설정
`.env` 파일에 다음 환경 변수가 설정되어 있어야 합니다:
- `OPENAI_API_KEY`: OpenAI API 키
- `SUPABASE_URL`: Supabase 프로젝트 URL
- `SUPABASE_KEY`: Supabase API 키

## 💡 사용법

### 기본 대화
```
👤 사용자: 안녕하세요
🤖 어시스턴트: 안녕하세요! 바른마디병원 AI 어시스턴트입니다. 😊

👤 사용자: 예약하고 싶어요
🤖 어시스턴트: 📋 **예약 정보 수집 중**

누락된 정보: 환자명, 전화번호

위 정보를 알려주시면 예약을 진행하겠습니다.
```

### 예약 시나리오
```
👤 사용자: 예약하고 싶어요
🤖 어시스턴트: 📋 **예약 정보 수집 중**
누락된 정보: 환자명, 전화번호

👤 사용자: 홍길동입니다. 010-1234-5678이에요
🤖 어시스턴트: ✅ **예약 정보 수집 완료**
👤 **환자 정보:**
• 이름: 홍길동
• 연락처: 010-1234-5678

어떤 증상으로 예약하시나요?

👤 사용자: 무릎이 아파요
🤖 어시스턴트: 👨‍⚕️ **의료진 추천 결과**
📋 **추천 진료과**: 정형외과
🎯 **추천 근거**: 무릎 통증은 정형외과 전문의의 진료가 필요합니다.
📊 **신뢰도**: 90.0%

**추천 의료진:**
1. **양재혁 의사**
   • 진료과: 정형외과
   • 추천 근거: 무릎 관절 전문의

📅 **다음 단계**: 예약을 원하시면 의료진을 선택하고 예약 정보를 알려주세요!
```

## 🔧 시스템 명령어

### `/help` - 도움말 표시
```
/help
```
사용 가능한 모든 명령어와 사용법을 표시합니다.

### `/status` - 세션 상태 확인
```
/status
```
현재 세션의 상태 정보를 확인합니다:
- 세션 ID
- 진행 시간
- 메시지 수
- 컨텍스트 정보
- 예약 정보

### `/history` - 대화 기록 보기
```
/history
```
지금까지의 모든 대화 기록을 시간순으로 표시합니다.

### `/clear` - 대화 기록 지우기
```
/clear
```
현재 세션의 모든 대화 기록과 컨텍스트를 지웁니다.

### `/save` - 세션 저장
```
/save
```
현재 세션을 JSON 파일로 저장합니다.
파일명: `chat_session_<세션ID>.json`

### `/load` - 세션 불러오기
```
/load <파일명>
```
이전에 저장한 세션을 불러옵니다.
예: `/load chat_session_abc12345.json`

### `/quit` 또는 `/exit` - 프로그램 종료
```
/quit
```
또는
```
/exit
```
프로그램을 안전하게 종료합니다.

## 📋 사용 예시

### 1. 예약하기
```
👤 사용자: 예약하고 싶어요
👤 사용자: 홍길동입니다. 010-1234-5678
👤 사용자: 무릎이 아파요
👤 사용자: 최대한 빨리 예약하고 싶어요
```

### 2. 의료진 추천
```
👤 사용자: 허리가 아파요
👤 사용자: 디스크가 있어서 어떤 의사를 봐야 할까요?
```

### 3. 병원 정보 조회
```
👤 사용자: 병원 휴무일이 언제인가요?
👤 사용자: 진료시간을 알려주세요
👤 사용자: 병원 전화번호가 뭐에요?
```

## 🎯 주요 기능

### ✅ 세션 관리
- 고유한 세션 ID로 대화 추적
- 컨텍스트 유지 (이전 대화 기억)
- 세션 저장/불러오기

### ✅ 다중 턴 대화
- 예약 정보 단계별 수집
- 의료진 추천 → 예약 플로우
- 자연어 일정 처리

### ✅ 사용자 친화적 인터페이스
- 타이핑 효과
- 이모지와 색상 구분
- 명령어 시스템

### ✅ 에러 처리
- 환경 변수 검증
- 예외 상황 처리
- 복구 메커니즘

## 🚨 주의사항

1. **환경 변수 설정**: 반드시 `.env` 파일에 필요한 API 키들이 설정되어 있어야 합니다.

2. **네트워크 연결**: OpenAI API와 Supabase에 접근할 수 있어야 합니다.

3. **세션 저장**: 중요한 대화는 `/save` 명령어로 저장해두세요.

4. **프라이버시**: 실제 환자 정보를 입력할 때는 주의하세요.

## 🔧 문제 해결

### 환경 변수 오류
```
❌ 다음 환경 변수가 설정되지 않았습니다: OPENAI_API_KEY
```
→ `.env` 파일을 확인하고 필요한 API 키를 설정하세요.

### 네트워크 오류
```
❌ 시스템 오류가 발생했습니다: Connection timeout
```
→ 인터넷 연결을 확인하고 다시 시도하세요.

### 세션 불러오기 오류
```
❌ 파일 'chat_session_abc12345.json'을 찾을 수 없습니다.
```
→ 파일명을 확인하고 올바른 경로에 있는지 확인하세요.

## 📞 지원

문제가 발생하면 다음을 확인해주세요:
1. 환경 변수 설정
2. 네트워크 연결
3. Python 패키지 설치 (`requirements.txt`)
4. Supabase 연결 상태

---

💡 **팁**: 처음 사용할 때는 `/help` 명령어로 모든 기능을 확인해보세요!
